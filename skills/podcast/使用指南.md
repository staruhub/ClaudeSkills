# 播客生成器技能 - 使用指南

## 技能概述

这是一个用于生成AI播客的Claude技能,使用火山引擎的播客大模型。可以将文本内容转换为双人对话形式的播客音频。

## 功能特点

- ✅ 双人对话播客生成
- ✅ 支持中文内容
- ✅ 多种音频格式(MP3/OGG/PCM/AAC)
- ✅ 可调节语速和音色
- ✅ 支持断点续传
- ✅ 流式音频接收

## 安装步骤

### 1. 安装技能文件

将 `podcast-generator.skill` 文件导入到Claude Code中:

```bash
# 使用Claude Code CLI安装技能
claude skills add podcast-generator.skill
```

或者通过Claude.ai网页界面上传技能文件。

### 2. 安装依赖

这个技能需要Python的websockets库:

```bash
pip install websockets
```

### 3. 获取火山引擎凭证

1. 访问火山引擎控制台: https://console.volcengine.com/speech/service/10028
2. 开启播客服务试用
3. 获取以下凭证:
   - APP ID
   - Access Key

## 使用方法

### 方法1: 通过Claude对话使用

直接在Claude对话中说:

```
帮我生成一个播客,主题是"分析当前大模型的发展趋势",保存为podcast.mp3
```

Claude会自动使用这个技能来生成播客。

### 方法2: 命令行直接使用

```bash
python scripts/generate_podcast.py \
  --text "分析下当前的大模型发展" \
  --output "my_podcast.mp3" \
  --app-id "你的APP_ID" \
  --access-key "你的ACCESS_KEY" \
  --format mp3 \
  --sample-rate 24000
```

### 方法3: Python脚本集成

```python
import asyncio
from scripts.generate_podcast import PodcastGenerator

async def main():
    # 初始化生成器
    generator = PodcastGenerator(
        app_id="你的APP_ID",
        access_key="你的ACCESS_KEY"
    )
    
    # 生成播客
    result = await generator.generate_podcast(
        input_text="分析下当前的大模型发展",
        output_path="podcast.mp3",
        audio_format="mp3",
        sample_rate=24000,
        speech_rate=0,
        use_head_music=False
    )
    
    if result['success']:
        print(f"✅ 播客生成成功: {result['output_path']}")
        print(f"文件大小: {result['file_size']:.2f} MB")
        print(f"对话轮次: {result['rounds']}")
    else:
        print(f"❌ 生成失败: {result.get('error')}")

asyncio.run(main())
```

## 参数说明

### 音频格式选项

| 格式 | 描述 | 适用场景 |
|------|------|----------|
| mp3 | 压缩格式,广泛支持 | 一般分发使用 |
| ogg_opus | 高质量压缩 | 高质量需求 |
| pcm | 未压缩原始音频 | 后期处理 |
| aac | 现代压缩格式 | 移动设备 |

### 语速调节

- `speech_rate=0`: 正常语速(1.0x)
- `speech_rate=50`: 1.5倍速
- `speech_rate=100`: 2倍速(最快)
- `speech_rate=-50`: 0.5倍速(最慢)

### 说话人选项

默认使用一男一女双人对话:
- 男声: `zh_male_dayixiansheng_v2_saturn_bigtts`
- 女声: `zh_female_mizaitongxue_v2_saturn_bigtts`

可以自定义说话人列表。

## 使用示例

### 示例1: 博客文章转播客

```python
blog_content = """
人工智能的发展已经进入了一个新的阶段...
[你的博客文章内容]
"""

result = await generator.generate_podcast(
    input_text=blog_content,
    output_path="blog_podcast.mp3"
)
```

### 示例2: 教育内容播客(较慢语速)

```python
result = await generator.generate_podcast(
    input_text="解释量子计算的基本概念",
    output_path="education.mp3",
    speech_rate=-20  # 稍慢以便理解
)
```

### 示例3: 新闻快报(快速语速)

```python
result = await generator.generate_podcast(
    input_text="今日科技新闻汇总",
    output_path="news.mp3",
    speech_rate=30,  # 较快语速
    use_head_music=True  # 添加开场音乐
)
```

## 限制说明

- **文本长度**: 最多25,000字符(模型会自动截断)
- **语言支持**: 主要针对中文优化
- **并发限制**: 受账户配额限制
- **网络要求**: 需要稳定的WebSocket连接

## 断点续传

如果生成过程中断,可以使用断点续传功能:

```python
result = await generator.generate_podcast(
    input_text="你的内容",
    output_path="podcast.mp3",
    retry_info={
        "retry_task_id": "之前的任务ID",
        "last_finished_round_id": 5  # 最后完成的轮次
    }
)
```

任务ID和轮次ID会在生成过程中显示在控制台输出中。

## 故障排查

### 连接失败

**问题**: 无法连接到服务
**解决**: 
- 检查APP_ID和Access Key是否正确
- 确认网络可以访问火山引擎服务
- 检查防火墙是否允许WebSocket连接

### 音频无输出

**问题**: 生成完成但没有音频文件
**解决**:
- 确认输出路径可写
- 检查磁盘空间是否充足
- 查看错误日志了解具体原因

### 生成中断

**问题**: 生成过程中断开连接
**解决**:
- 记录控制台中显示的task_id和last_finished_round_id
- 使用断点续传功能重新生成
- 检查网络稳定性

### 配额超限

**问题**: 错误代码45000000
**解决**:
- 减少并发请求数量
- 等待当前请求完成后再发起新请求
- 联系火山引擎升级配额

## 技能文件结构

```
podcast-generator/
├── SKILL.md                      # 技能主文档
├── scripts/
│   └── generate_podcast.py      # 播客生成脚本
└── references/
    └── api_reference.md         # API详细参考
```

## 相关资源

- **火山引擎控制台**: https://console.volcengine.com/speech/service/10028
- **API文档**: https://www.volcengine.com/docs/6561/1668014
- **Claude Skills文档**: https://docs.claude.com/zh-CN/docs/claude-code/skills

## 技术支持

如遇问题:
1. 查看控制台输出中的X-Tt-Logid
2. 保存详细的错误信息
3. 联系火山引擎技术支持并提供logid

## 许可证

本技能遵循MIT许可证,可自由使用和修改。

---

**版本**: 1.0.0  
**创建日期**: 2025-10-27  
**作者**: Pong
